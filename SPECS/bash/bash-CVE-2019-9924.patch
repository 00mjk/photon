diff -ru a/variables.c b/variables.c
--- a/variables.c	2014-02-14 16:55:12.000000000 +0000
+++ b/variables.c	2019-04-24 20:38:42.314030052 +0000
@@ -1584,6 +1584,13 @@
      arrayind_t ind;
      char *key;
 {
+#if defined (RESTRICTED_SHELL)
+  if (restricted && strchr (value, '/'))
+    {
+      sh_restricted (value);
+      return (SHELL_VAR *)NULL;
+    }
+#endif
   phash_insert (key, value, 0, 0);
   return (build_hashcmd (self));
 }
