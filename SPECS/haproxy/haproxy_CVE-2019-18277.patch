--- a/src/proto_http.c	2019-10-31 11:33:53.982903925 +0530
+++ b/src/proto_http.c	2019-10-31 11:36:17.066907479 +0530
@@ -1073,6 +1073,10 @@ int http_wait_for_request(struct stream
 		}
 	}
 
+	/* "chunked" mandatory if transfer-encoding is used */
+	if (ctx.idx && !(msg->flags & HTTP_MSGF_TE_CHNK))
+		goto return_bad_req;
+
 	/* Chunked requests must have their content-length removed */
 	ctx.idx = 0;
 	if (msg->flags & HTTP_MSGF_TE_CHNK) {
@@ -4696,6 +4700,12 @@ int http_wait_for_response(struct stream
 		}
 	}
 
+	/* "chunked" mandatory if transfer-encoding is used */
+	if (ctx.idx && !(msg->flags & HTTP_MSGF_TE_CHNK)) {
+		use_close_only = 1;
+		msg->flags &= ~(HTTP_MSGF_TE_CHNK | HTTP_MSGF_XFER_LEN);
+	}
+
 	/* Chunked responses must have their content-length removed */
 	ctx.idx = 0;
 	if (use_close_only || (msg->flags & HTTP_MSGF_TE_CHNK)) {
