diff -Naurp curl-7.59.0-original/lib/tftp.c curl-7.59.0/lib/tftp.c
--- curl-7.59.0-original/lib/tftp.c	2019-09-23 07:37:15.118712556 +0000
+++ curl-7.59.0/lib/tftp.c	2019-09-23 07:49:24.153673745 +0000
@@ -970,6 +970,7 @@ static CURLcode tftp_connect(struct conn
 {
   tftp_state_data_t *state;
   int blksize, rc;
+  int need_blksize;
 
   blksize = TFTP_BLKSIZE_DEFAULT;
 
@@ -984,15 +985,20 @@ static CURLcode tftp_connect(struct conn
       return CURLE_TFTP_ILLEGAL;
   }
 
+  need_blksize = blksize;
+  /* default size is the fallback when no OACK is received */
+  if(need_blksize < TFTP_BLKSIZE_DEFAULT)
+    need_blksize = TFTP_BLKSIZE_DEFAULT;
+
   if(!state->rpacket.data) {
-    state->rpacket.data = calloc(1, blksize + 2 + 2);
+    state->rpacket.data = calloc(1, need_blksize + 2 + 2);
 
     if(!state->rpacket.data)
       return CURLE_OUT_OF_MEMORY;
   }
 
   if(!state->spacket.data) {
-    state->spacket.data = calloc(1, blksize + 2 + 2);
+    state->spacket.data = calloc(1, need_blksize + 2 + 2);
 
     if(!state->spacket.data)
       return CURLE_OUT_OF_MEMORY;
